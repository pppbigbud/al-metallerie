/**
 * AL Metallerie - Main JS (Minified)
 * @package ALMetallerie
 */
(function($){'use strict';function initMobileMenu(){const t=$('.mobile-menu-toggle'),n=$('.main-navigation');t.on('click',function(){const e=n.hasClass('is-open');n.toggleClass('is-open'),$(this).attr('aria-expanded',!e);$(this).find('.menu-icon').text(e?'☰':'✕')}),n.find('a').on('click',function(){$(window).width()<=768&&(n.removeClass('is-open'),t.attr('aria-expanded','false'),t.find('.menu-icon').text('☰'))})}function initSmoothScroll(){$('a[href^="#"]').on('click',function(e){const t=$(this.getAttribute('href'));t.length&&(e.preventDefault(),$('html, body').stop().animate({scrollTop:t.offset().top-80},800,'swing'))})}function initScrollToTop(){const t=$('#scroll-to-top');t.length&&($(window).on('scroll',function(){$(this).scrollTop()>300?t.addClass('visible'):t.removeClass('visible')}),t.on('click',function(e){e.preventDefault(),$('html, body').animate({scrollTop:0},600)}))}function initScrollSpy(){if(!$('body').hasClass('one-page-layout'))return;const t=$('.onepage-section'),n=$('.main-navigation a[href^="#"]');$(window).on('scroll',function(){let e='';const i=$(this).scrollTop()+100;t.each(function(){const t=$(this).offset().top,n=$(this).outerHeight(),o=$(this).attr('id');i>=t&&i<t+n&&(e=o)}),n.removeClass('active'),n.filter('[href="#'+e+'"]').addClass('active')})}function initLazyLoading(){if('loading'in HTMLImageElement.prototype){document.querySelectorAll('img[loading="lazy"]').forEach(e=>{e.dataset.src&&(e.src=e.dataset.src)})}else{const e=document.createElement('script');e.src='https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.3.2/lazysizes.min.js',document.body.appendChild(e)}}function initScrollAnimations(){const e={threshold:.1,rootMargin:'0px 0px -50px 0px'},t=new IntersectionObserver(function(e){e.forEach(e=>{e.isIntersecting&&(e.target.classList.add('is-visible'),t.unobserve(e.target))})},e);document.querySelectorAll('.onepage-section, article').forEach(e=>{e.classList.add('fade-in'),t.observe(e)})}function initOrangeBarScrollAnimation(){const e=document.querySelector('.presentation-section'),t=document.querySelector('.presentation-orange-bar');if(!e||!t)return;function n(){const n=e.getBoundingClientRect(),o=window.innerHeight,i=n.top,s=.7*o,a=-.5*o,r=s-a,c=Math.max(0,Math.min(r,s-i)),l=c/r*70;t.style.height=l+'%',l>.05*70?e.classList.add('fade-in'):e.classList.remove('fade-in')}let o=!1;window.addEventListener('scroll',function(){o||(window.requestAnimationFrame(function(){n(),o=!1}),o=!0)}),n()}function initForms(){$('form').on('submit',function(e){const t=$(this);let n=!0;t.find('[required]').each(function(){$(this).val()?$(this).removeClass('error'):(n=!1,$(this).addClass('error'))}),n||(e.preventDefault(),alert('Veuillez remplir tous les champs obligatoires.'))}),$('input, textarea, select').on('input change',function(){$(this).removeClass('error')})}function detectDevice(){/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&$('body').addClass('is-touch-device')}function initHeroCarousel(){const e=$('.hero-carousel');if(!e.length)return;const t=e.find('.hero-slide'),n=e.find('.hero-prev'),o=e.find('.hero-next'),i=e.find('.hero-indicators');let s=0,a;const r=5e3;t.each(function(e){const t=$('<button class="hero-indicator"></button>');t.attr('aria-label','Aller au slide '+(e+1)),t.on('click',function(){c(e)}),i.append(t)});const l=i.find('.hero-indicator');function c(e){t.removeClass('active'),l.removeClass('active'),s=e,$(t[s]).addClass('active'),$(l[s]).addClass('active'),d()}function u(){let e=s+1;e>=t.length&&(e=0),c(e)}function f(){a=setInterval(u,r)}function d(){clearInterval(a),f()}n.on('click',function(){let e=s-1;e<0&&(e=t.length-1),c(e)}),o.on('click',function(){u()}),e.on('mouseenter',function(){clearInterval(a)}),e.on('mouseleave',function(){f()}),$(document).on('keydown',function(n){e.is(':visible')&&('ArrowLeft'===n.key?function(){let e=s-1;e<0&&(e=t.length-1),c(e)}():'ArrowRight'===n.key&&u())}),c(0)}function initRealisationsFilter(){if(document.querySelector('.archive-page .archive-grid.realisations-grid'))return;const e=$('.archive-realisations .filter-btn, .realisations-archive .filter-btn'),t=$('.archive-realisations .realisation-card, .realisations-archive .realisation-card');e.length&&t.length&&e.on('click',function(){const n=$(this).data('filter');e.removeClass('active'),$(this).addClass('active'),'*'===n?t.fadeOut(200,function(){$(this).show().addClass('is-visible')}).fadeIn(400):(t.fadeOut(200,function(){$(this).removeClass('is-visible')}),setTimeout(function(){t.filter(n).fadeIn(400,function(){$(this).addClass('is-visible')})},200))})}function initActualitesFilter(){const e=$('.actualites-filters .filter-btn'),t=$('.actualite-card');e.length&&t.length&&e.on('click',function(){const n=$(this).data('filter');e.removeClass('active'),$(this).addClass('active'),'*'===n?t.fadeOut(200,function(){$(this).show().removeClass('hidden')}).fadeIn(400):(t.fadeOut(200,function(){$(this).addClass('hidden')}),setTimeout(function(){t.filter(n).fadeIn(400,function(){$(this).removeClass('hidden')})},200))})}function initHeaderScroll(){const e=$('.site-header');$(window).on('scroll',function(){$(this).scrollTop()>200?e.addClass('scrolled'):e.removeClass('scrolled')}),$(window).scrollTop()>200&&e.addClass('scrolled')}function initDropdownMenu(){$(window).width()>992&&$('.menu-item.has-dropdown').hover(function(){$(this).find('.dropdown-menu').first().stop(!0,!0).fadeIn(200)},function(){$(this).find('.dropdown-menu').first().stop(!0,!0).fadeOut(200)}),$('.menu-item.has-dropdown > a').on('click',function(e){if($(window).width()<=992){e.preventDefault();const t=$(this).parent();t.toggleClass('dropdown-open'),$('.menu-item.has-dropdown').not(t).removeClass('dropdown-open')}}),$(window).on('resize',function(){$(window).width()>992&&($('.menu-item.has-dropdown').removeClass('dropdown-open'),$('.dropdown-menu').removeAttr('style'))})}$(document).ready(function(){initHeaderScroll(),initDropdownMenu(),initMobileMenu(),initSmoothScroll(),initScrollToTop(),initScrollSpy(),initLazyLoading(),initScrollAnimations(),initOrangeBarScrollAnimation(),initForms(),detectDevice(),initHeroCarousel(),initRealisationsFilter(),initActualitesFilter(),'undefined'!=typeof almetalData&&console.log('AL Metallerie Theme loaded')});function initActualitesIconAnimation(){const e=document.querySelector('.actualites-section');if(!e)return;function t(){e.getBoundingClientRect().top<.7*window.innerHeight&&e.classList.add('animate-megaphone')}window.addEventListener('scroll',t),t()}initActualitesIconAnimation(),$(window).on('load',function(){$('.page-loader').fadeOut()})})(jQuery);
